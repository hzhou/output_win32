#---------------------------------------- 
subcode: get_hdc(hwnd)
    hdc = GetDC($(hwnd))
    BLOCK
    ReleaseDC($(hwnd), hdc)

#---------------------------------------- 
subcode: quick_gdi(obj)
    $temp HGDIOBJ old
    $(old)=SelectObject(hdc, $(obj))
    BLOCK
    SelectObject(hdc, $(old))

#---------------------------------------- 
# -- PEN ---------------------
subcode: create_pen(var, @plist)
    $local HPEN t_new_pen
    $(mset:ps=PS_SOLID,pw=0,color=0)
    $(ifeach:p:3=PS_)
        $(export:ps=$(p))
    $(ifeach:p~[0-9]+)
        $(export:pw=$(p))
    $(ifeach:p:6=color_)
        $(export:color=$(p))
    t_new_pen=CreatePen($(ps), $(pw), $(color))

subcode: quick_pen(@plist)
    $call create_pen, t_new_pen, $(plist)
    &call quick_gdi, t_new_pen
        BLOCK
    DeleteObject(t_new_pen)

# -- Brush -------------------------
subcode: create_brush(var, @plist)
    # $local HBRUSH $(var)
    $(set:color=0)
    $(ifeach:p:6=color_ or p:2=0x)
        $(export:color=$(p))
    $(var)=CreateSolidBrush($(color))

subcode: quick_brush(@plist)
    $call create_brush, t_new_brush, $(plist)
    &call quick_gdi, t_new_brush
        BLOCK
    DeleteObject(t_new_brush)

# -- Font -----------------------------------
subcode: create_font(var, name, size)
    $(var) = CreateFont ($(size), 0, 0, 0, FW_DONTCARE, FALSE, FALSE, FALSE, ANSI_CHARSET, OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS, DEFAULT_QUALITY, FF_DONTCARE, $(name))

subcode: quick_font(fontname, size)
    $my HFONT t_new_font
    $call create_font, t_new_font, $(fontname), $(size)
    &call quick_gdi, t_new_font
        BLOCK
    DeleteObject(t_new_font)

